<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>JET FIGHTER - HATEM WAR</title>
    <script src="https://telegram.org/js/games.js"></script>
    <style>
        body { margin: 0; overflow: hidden; background: #000b1a; touch-action: none; font-family: 'Segoe UI', sans-serif; }
        canvas { display: block; }
        #hud {
            position: absolute; top: 15px; left: 15px; color: #00f2ff;
            background: rgba(0, 20, 40, 0.8); padding: 12px; border-radius: 10px;
            border: 2px solid #00f2ff; pointer-events: none; box-shadow: 0 0 15px #00f2ff;
        }
        #radar {
            position: absolute; bottom: 20px; right: 20px; width: 120px; height: 120px;
            background: rgba(0, 40, 0, 0.5); border: 2px solid #00ff00; border-radius: 50%;
        }
    </style>
</head>
<body>

<div id="hud">
    <div style="font-weight: bold; font-size: 1.1em;">HATEM WAR</div>
    <div style="margin-top: 5px; color: yellow;">SCORE: <span id="score">0</span></div>
</div>
<canvas id="radar"></canvas>
<canvas id="gameCanvas"></canvas>

<script>
const WORLD_SIZE = 10000;
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const rCanvas = document.getElementById('radar');
const rCtx = rCanvas.getContext('2d');

let w, h;
const player = { x: WORLD_SIZE/2, y: WORLD_SIZE/2, angle: 0, speed: 0, maxSpeed: 16, score: 0 };
let ammos = [];
const joy = { active: false, x: 0, y: 0, currX: 0, currY: 0, r: 70 };

// صور الجرافيك الجديدة
const jetImg = new Image();
jetImg.src = 'https://i.imgur.com/8Q0N6Wf.png'; // طائرة حربية
const bgImg = new Image();
bgImg.src = 'https://i.imgur.com/G5yQx8z.jpg'; // فضاء أزرق

function init() {
    resize();
    for(let i=0; i<200; i++) ammos.push({ x: Math.random()*WORLD_SIZE, y: Math.random()*WORLD_SIZE });
    requestAnimationFrame(loop);
}

function resize() {
    w = canvas.width = window.innerWidth;
    h = canvas.height = window.innerHeight;
    rCanvas.width = 120; rCanvas.height = 120;
}

window.addEventListener('touchstart', e => {
    const t = e.touches[0];
    if(t.clientX < w/2) {
        joy.active = true; joy.x = t.clientX; joy.y = t.clientY;
        joy.currX = t.clientX; joy.currY = t.clientY;
    }
});

window.addEventListener('touchmove', e => {
    if(!joy.active) return;
    const t = e.touches[0];
    const dx = t.clientX - joy.x;
    const dy = t.clientY - joy.y;
    const angle = Math.atan2(dy, dx);
    const dist = Math.min(Math.sqrt(dx*dx + dy*dy), joy.r);
    joy.currX = joy.x + Math.cos(angle) * dist;
    joy.currY = joy.y + Math.sin(angle) * dist;
    player.angle = angle;
    player.speed = (dist/joy.r) * player.maxSpeed;
});

window.addEventListener('touchend', () => { joy.active = false; player.speed *= 0.9; });

function drawPlayer() {
    ctx.save();
    ctx.translate(w/2, h/2);
    ctx.rotate(player.angle + Math.PI/2);
    if(player.speed > 2) {
        ctx.fillStyle = '#ff6600';
        ctx.shadowBlur = 20; ctx.shadowColor = 'red';
        ctx.beginPath(); ctx.moveTo(-10, 30); ctx.lineTo(0, 60 + Math.random()*20); ctx.lineTo(10, 30); ctx.fill();
    }
    ctx.drawImage(jetImg, -45, -45, 90, 90);
    ctx.restore();
}

function update() {
    player.x += Math.cos(player.angle) * player.speed;
    player.y += Math.sin(player.angle) * player.speed;
    player.x = Math.max(0, Math.min(WORLD_SIZE, player.x));
    player.y = Math.max(0, Math.min(WORLD_SIZE, player.y));
    ammos = ammos.filter(a => {
        if(Math.sqrt((player.x-a.x)**2 + (player.y-a.y)**2) < 50) {
            player.score += 10;
            document.getElementById('score').innerText = player.score;
            return false;
        }
        return true;
    });
}

function draw() {
    ctx.fillStyle = '#000b1a'; ctx.fillRect(0,0,w,h);
    ctx.save();
    ctx.globalAlpha = 0.5;
    for(let i=-1; i<=1; i++) {
        for(let j=-1; j<=1; j++) {
            let bgX = (-(player.x * 0.5) % w) + (i * w);
            let bgY = (-(player.y * 0.5) % h) + (j * h);
            ctx.drawImage(bgImg, bgX, bgY, w, h);
        }
    }
    ctx.restore();
    ctx.save();
    ctx.translate(w/2 - player.x, h/2 - player.y);
    ctx.strokeStyle = '#003366';
    for(let i=0; i<=WORLD_SIZE; i+=500) {
        ctx.beginPath(); ctx.moveTo(i, 0); ctx.lineTo(i, WORLD_SIZE); ctx.stroke();
        ctx.beginPath(); ctx.moveTo(0, i); ctx.lineTo(WORLD_SIZE, i); ctx.stroke();
    }
    ctx.fillStyle = '#ffff00';
    ammos.forEach(a => {
        ctx.beginPath(); ctx.arc(a.x, a.y, 10, 0, Math.PI*2); ctx.fill();
    });
    ctx.restore();
    drawPlayer();
    if(joy.active) {
        ctx.strokeStyle = 'rgba(0, 242, 255, 0.3)';
        ctx.beginPath(); ctx.arc(joy.x, joy.y, joy.r, 0, Math.PI*2); ctx.stroke();
        ctx.fillStyle = 'rgba(0, 242, 255, 0.5)';
        ctx.beginPath(); ctx.arc(joy.currX, joy.currY, 30, 0, Math.PI*2); ctx.fill();
    }
    drawRadar();
}

function drawRadar() {
    rCtx.clearRect(0,0,120,120);
    rCtx.fillStyle = '#00ff00';
    rCtx.beginPath(); rCtx.arc(player.x*(120/WORLD_SIZE), player.y*(120/WORLD_SIZE), 4, 0, Math.PI*2); rCtx.fill();
}

function loop() { update(); draw(); requestAnimationFrame(loop); }
init();
window.addEventListener('resize', resize);
</script>
</body>
</html>
